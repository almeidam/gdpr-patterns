<!doctype html>
<html>
<head>
    <title>Neovis.js Simple Example</title>
    <style type="text/css">
        html, body {
            font: 16pt arial;
        }

        #viz {
            width: 700px;
            height: 700px;
            border: 1px solid lightgray;
            font: 22pt arial;
        }
    </style>
</head>
<body onload="draw()">
<h1>{{ .Params.title }}</h1>
{{ .Content }}

<script >
    var params_Data = {
        cypher        : "{{ .Params.cypher }}",
        labels        : {{ safeJS (partial "toJson.html" .Params.labels)        }},
        relationships : {{ safeJS (partial "toJson.html" .Params.relationships) }},
        options       : {
            gravitationalConstant: {{ safeJS (default "-800" .Params.gravity) }}
        }
    }


</script>



<div id="viz"></div>
<script src="http://localhost:3000/api/js/neovis.js"></script>
<script type="text/javascript">

    var viz;

    async function draw() {
        var config = {
            container_id    : "viz",
            server_url      : "{{ .Site.Data.neo4j_server.url       }}",
            server_user     : "{{ .Site.Data.neo4j_server.user      }}",
            server_password : "{{ .Site.Data.neo4j_server.password  }}",
            labels          : params_Data.labels,
            relationships   : params_Data.relationships,
            initial_cypher  : params_Data.cypher
        };

        viz = new NeoVis.default(config);
        //viz.render();
        viz.setup()
        await viz.render_async()

        options = {
            physics  : {
                barnesHut: {
                    gravitationalConstant: params_Data.options.gravitationalConstant,
                } } }

        viz._network.setOptions(options)


    }
</script>
</body>
</html>